package screens;

import com.badlogic.gdx.Gdx;
import com.badlogic.gdx.Input;
import com.badlogic.gdx.audio.Music;
import com.badlogic.gdx.graphics.OrthographicCamera;
import com.badlogic.gdx.graphics.Texture;
import com.badlogic.gdx.graphics.g2d.Batch;
import com.badlogic.gdx.graphics.g2d.SpriteBatch;
import com.badlogic.gdx.scenes.scene2d.Actor;
import com.badlogic.gdx.scenes.scene2d.ui.Image;

import game.Demo;
import game.Parametros;
import managers.AudioManager;
import managers.ResourceManager;
import ow_elements.Reloj;
import ow_elements.Texto;

public class FinalScreen extends BScreen {
private OrthographicCamera camera;
private Batch batch;
private Texture blackBackground;
private Actor blackBackgroundActor;
private Music musicaCiudad;
private Music ruido;
private Music tiktak;
private int contador = 0;
private Texto texto;
private Texture protagonistaMT;
private Actor protagonistaM;

    public FinalScreen(Demo game) {
        super(game);

        texto = new Texto("Se acabó.\n", "talk1");
        texto.completo=true;
		ruido = Gdx.audio.newMusic(Gdx.files.internal("01-FS/Audio/music/final.wav"));
        camera.setToOrtho(false, Parametros.getAltoPantalla(), Parametros.getAltoPantalla());

        batch = new SpriteBatch();
	    
        Reloj.tiempoRestante = Parametros.segundosBaseOW;
	    protagonistaMT = new Texture("02-OW/personajes/personaje.ahorcado.png");
	    protagonistaM = new Image(protagonistaMT);
	    protagonistaM.setBounds(342, 250, 100, 158);
	    ResourceManager.musicaTitulo.stop();
	    ruido.setLooping(true);
	    ruido.setVolume(0.2f);
        
        blackBackground = new Texture("Menu/blackBackground.png");
        blackBackgroundActor = new Image(blackBackground);
        this.uiStage.addActor(blackBackgroundActor);
        
	    ruido.play();
    }

    public boolean touchDown(int screenX, int screenY, int pointer, int button) {

		if(texto.completo==true) {
	    			if (button == Input.Buttons.LEFT && Parametros.frontera==false && contador==0 && texto.completo==true) {
	     	        	texto.remove();
	     	            texto = new Texto("Ya te lo dije, Evans... No podemos quedarnos,\nAlemania ya no es un lugar seguro para nosotros.", "talk1");
	     	            this.uiStage.addActor(texto);
	     	            contador ++;
	     	        }
	    			else if (button == Input.Buttons.LEFT && Parametros.frontera==false && contador==1 && texto.completo==true) {
	     	        	texto.remove();
	     	            texto = new Texto("Debes ser paciente, ¿Vale? Te prometo\nque mientras estemos juntos, todo irá bien.", "talk1");
	     	            this.uiStage.addActor(texto);
	     	            contador ++;
	     	        }
	    			else if (button == Input.Buttons.LEFT && Parametros.frontera==false && contador==2 && texto.completo==true) {
	     	        	texto.remove();
	     	            texto = new Texto("Está bien, pero...\n¿No vamos a volver nunca más?", "talk2");
	     	            this.uiStage.addActor(texto);
	     	            contador ++;
	     	        }
	    			else if (button == Input.Buttons.LEFT && Parametros.frontera==false && contador==3 && texto.completo==true) {
	     	        	texto.remove();
	     	            texto = new Texto("Quizás... Dentro de mucho, mucho tiempo...\nVamos, tenemos un largo camino por delante...", "talk1");
	     	            this.uiStage.addActor(texto);
	     	            contador ++;
	     	        }
	    	        else if (button == Input.Buttons.LEFT && Parametros.frontera==false && contador==4 && texto.completo==true) {
	    	        	texto.remove();
	    	        	protagonistaM.remove();
	    	        	ruido.stop();
	    	            game.setScreen(new OverWorldScreen(game, musicaCiudad, tiktak));
	    	            contador ++;
	    	        }
	    	        else if (button == Input.Buttons.LEFT && Parametros.frontera==true) {
	    	            ResourceManager.musicaTitulo.stop();
	    	            Parametros.zoom=0.30f;
	    	            game.setScreen(new FrontierScreen(game));
	    	        }
		} else {
    		texto.completo=true;
            AudioManager.playSound("01-FS/Audio/sounds/menuBoton.wav");
    	}
    	
        return false;
    }

    @Override
    public void render(float delta) {

        super.render(delta);
        uiStage.act();

        batch.begin();
        batch.draw(blackBackground, 0, 0, Parametros.getAnchoPantalla(), Parametros.getAltoPantalla());
        batch.end();

        uiStage.draw();
    }
}
