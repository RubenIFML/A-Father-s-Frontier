package ow_elements;

import com.badlogic.gdx.scenes.scene2d.Stage;
import com.badlogic.gdx.scenes.scene2d.ui.Label;

import screens.OverWorldScreen;

public class Blob extends Enemigo{
	
	private Element pie;
	private Element cabeza;
	private int direccion;
	private float velocidad;
	private boolean pisa;
	private boolean choca;
	
	public Blob(float x, float y, Stage s, OverWorldScreen nivel) {
		super(x,y,s,nivel);

        prepararAnimacion("02-OW/Personajes/personaje.chica1_ow.png");
        setAnimation(idleFrente);
        this.setPolygon(8, 32, 23, 5, 5);
        
		direccion=-1;
		
		pie=new Element(0,0,s,this.getWidth()/4,this.getHeight()/4);
		pie.setRectangle();
		ajustarPie();
		
		cabeza=new Element(0,0,s,this.getWidth()/4,this.getHeight()/4);
		cabeza.setRectangle();
		ajustarCabeza();
		velocidad=0;
		vida=50;
	}
	
	
	public void act(float delta) {
		super.act(delta);
		comprobarColisiones();
		
		
		moveBy(direccion*velocidad*delta,0);
		ajustarPie();
		ajustarCabeza();
		
	}

	private void ajustarPie(){
		if(direccion==-1) {
			pie.setPosition(this.getX(),this.getY()-this.getHeight()/8);
		}else {
			pie.setPosition(this.getX()+this.getWidth()*3/4, this.getY()-this.getHeight()/8);
			
		}
		
		
	}
	
	private void ajustarCabeza() {
		if(direccion==-1) {
			cabeza.setPosition(this.getX()-this.getWidth()/8,this.getY()+this.getHeight()*7/8);
		}else {
			cabeza.setPosition(this.getX()+this.getWidth()*7/8, this.getY()+this.getHeight()*7/8);
			
		}
		
		
	}
	
	private void comprobarColisiones() {
		pisa=false;
		choca=false;
		
		for(Solid solido:this.nivel.solidos) {
			if(pie.overlaps(solido)) {
				pisa=true;
				
				
			}
			if(cabeza.overlaps(solido)) {
				choca=true;
			}
			
		}
		if(!pisa||choca) {
			this.direccion*=-1;
		}
		
	}
	
}
